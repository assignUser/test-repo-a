name: WebDav
on:
  workflow_dispatch:

jobs:
  # test-linux:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - run: | 
  #         sudo apt update && sudo apt install davfs2
  #         mkdir nightly
  #         sudo bash -c 'echo "https://nightly.wujciak.de:8080 ${{ secrets.ASF_USER }} ${{ secrets.ASF_KEY }}" >> /etc/davfs2/secrets'
  #         sudo mount -t davfs https://nightly.wujciak.de:8080 nightly -o rw
  #         ls -la nightly
  test-mac:
    runs-on: macos-latest
    steps:
      - uses: r-lib/actions/setup-r@v2
        with:
          install-r: false
      - run: |
          install.packages("oskeyring")
          library(oskeyring)
          macos_keychain_list()
        shell: Rscript {0}
      # - name: Set up keychain
      #   env:
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      #     ASF_USER: ${{ secrets.ASF_USER }}
      #     ASF_KEY: ${{ secrets.ASF_KEY }}
      #   run: bash fix-keychain.sh
      # - run: |
      #     sudo mkdir /Volumes/nightly
      #     sudo mount_webdav https://nightly.wujciak.de:8080 /Volumes/nightly
      #     ls -la /Volumes/nightly